<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Name of Product Here</title>
		<link rel="stylesheet" type="text/css" href="MainWindow.css" media="screen">
	</head>
	<body onload="sendReady()">
		<h1>Current Slide Deck</h1>
		<ul></ul>
		<script>
			//(1)add deck display
			const electron = require('electron');
			const mathJax = require('mathjax-electron');
			const {ipcRenderer} = electron;
			const ul = document.querySelector('ul');

			function sendReady(){
				ipcRenderer.send('MainReady',null);
			}

			function sendSlideUpdate(index,theDivs){
				var titlediv = theDivs[0];
				var textdiv = theDivs[2];
				listTemp = [];
				listTemp.push(index);
				listTemp.push(titlediv.childNodes[0].value);
				listTemp.push(textdiv.childNodes[0].value);
				ipcRenderer.send('singleSlideUpdate',listTemp);
			}

			ipcRenderer.on('load',function(e,info){
				ul.innerHTML = "";
				for(var index in info){
					item = info[index];
					//make the div and text for the slide
					const newSlide = document.createElement('div');
					const titlediv = document.createElement('div');
					const itemTitle = document.createElement('textarea');
					const textdiv = document.createElement('div');
					const itemText = document.createElement('textarea');

					//set their classes
					newSlide.className = "slide";
					itemTitle.className = "slide-title";
					itemText.className = "slide-text";
					titlediv.className = "title-div";
					textdiv.className = "text-div";

					//populate the text
					itemTitle.append(item[0]);
					itemText.append(item[2]);

					//make the text editable
					itemTitle.contentEditable= "true";
					itemText.contentEditable = "true";

					itemTitle.onchange = function(){sendSlideUpdate(index,itemTitle.parentNode.parentNode.childNodes)}
					itemText.onchange = function(){sendSlideUpdate(index,itemText.parentNode.parentNode.childNodes)}

					titlediv.appendChild(itemTitle);
					const newLine = document.createElement('br');
					newLine.style.position = "absolute";
					textdiv.appendChild(itemText);

					//add them to the slide
					newSlide.appendChild(titlediv);
					newSlide.appendChild(document.createElement('br'));
					newSlide.appendChild(textdiv);

					//add the new slide to the list
					ul.append(newSlide);
					ul.appendChild(document.createElement('br'));
				}
			});

			ipcRenderer.on('pleaseSend',function(e,item){
				list = ul.children;
				finalList = [];
				for(var index = 0; index < list.length; index++){
					var currentSlide = list[index];
					listChildren = currentSlide.children;
					tempList = [];
					for(var indexI = 0; indexI < listChildren.length; indexI++){
						var currentNode = listChildren[indexI];
						tempList.push(currentNode.innerHTML);
					}
					tempList.push(index);
					finalList.push(tempList);
				}
				ipcRenderer.send('SlideDeckUpdates',finalList);
			});

		</script>
		<script src="./node_modules/mathjax-electron/resources/MathJax/MathJax.js?config=electron">
			
		</script>
	</body>
</html>
